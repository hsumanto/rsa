# The base service is referenced in other projects.
base:
    build: .


dev:
    extends:
        service: base
    links:
        - postgres:rsadb
    volumes_from:
        - data
    entrypoint: []
    command: bash


web:
    extends:
        service: base
    links:
        - seed
        - postgres:rsadb
    volumes_from:
        - data
    command: web


seed:
    extends:
        service: base
    # Hostname acts like a link to self
    hostname: seed
    links:
        - postgres:rsadb
    volumes_from:
        - data
    command: seed


worker:
    extends:
        service: base
    links:
        - seed
        - postgres:rsadb
    volumes_from:
        - data
    command: worker


data:
    build: .
    volumes:
        - ./src:/var/src/rsa/src
        - ./data:/var/src/rsa/data
        - ../config/rsa:/var/src/rsa/config
        - ./test-config:/var/src/rsa/test-config
        - ./.gradle-cache:/root/.gradle/caches
    entrypoint: []
    command: echo "RSA test data container"


postgres:
    image: postgres:9
